var microsoftTeams;!function(t){"use strict";function e(){if(!M){M=!0,k=this._window||window;var t=function(t){return u(t)};k.addEventListener("message",t,!1),C=k.parent!==k.self?k.parent:k.opener;try{b="*";var e=p(C,"initialize",[O]);U[e]=function(t,e){N=t,T=e}}finally{b=null}this._uninitialize=function(){N===D.settings&&W.registerOnSaveHandler(null),N===D.remove&&W.registerOnRemoveHandler(null),M=!1,C=null,b=null,F=[],S=null,E=null,I=[],R=0,U={},N=null,T=null,k.removeEventListener("message",t,!1)}}}function n(t){a();var e=p(C,"getContext");U[e]=t}function i(t){a(),L=t}function o(t){L&&L(t),S&&p(S,"themeChange",[t])}function r(t){a();var e=p(C,"navigateCrossDomain",[t]);U[e]=function(t){if(!t)throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")}}function s(t){a(D.content),p(C,"shareDeepLink",[t.deepLinkContext,t.label,t.webUrl])}function a(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(!M)throw new Error("The library has not yet been initialized");if(N&&t&&t.length>0){for(var n=!1,i=0;i<t.length;i++)if(t[i]===N){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+N+"' context")}}function u(t){if(t&&t.data&&"object"==typeof t.data){var e=t.source||t.originalEvent.source,n=t.origin||t.originalEvent.origin;e===k||n!==k.location.origin&&H.indexOf(n.toLowerCase())===-1||(c(e,n),e===C?f(t):e===S&&l(t))}}function c(t,e){C&&t!==C?S&&t!==S||(S=t,E=e):(C=t,b=e),C&&C.closed&&(C=null,b=null),S&&S.closed&&(S=null,E=null),g(C),g(S)}function f(t){if("id"in t.data){var e=t.data,n=U[e.id];n&&n.apply(null,e.args)}else if("func"in t.data){var e=t.data,i=z[e.func];i&&i.apply(this,e.args)}}function l(t){if("id"in t.data&&"func"in t.data){var e=t.data,n=z[e.func];if(n){var i=n.apply(this,e.args);i&&y(S,e.id,Array.isArray(i)?i:[i])}else{var o=p(C,e.func,e.args);U[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];S&&y(S,e.id,t)}}}}function h(t){return t===C?F:t===S?I:[]}function d(t){return t===C?b:t===S?E:null}function g(t){for(var e=d(t),n=h(t);t&&e&&n.length>0;)t.postMessage(n.shift(),e)}function v(t,e){var n=setInterval(function(){0===h(t).length&&(clearInterval(n),e())},100)}function p(t,e,n){var i=m(e,n),o=d(t);return o?t.postMessage(i,o):h(t).push(i),i.id}function y(t,e,n){var i=w(e,n),o=d(t);o&&t.postMessage(i,o)}function m(t,e){return{id:R++,func:t,args:e||[]}}function w(t,e){return{id:t,args:e||[]}}var k,C,b,S,E,N,T,L,O="0.3",H=["https://teams.microsoft.com","https://teams.skype.com","https://ppespaces.skype.com","https://devspaces.skype.com","https://ssauth.skype.com","http://dev.local"],z={},D={settings:"settings",content:"content",authentication:"authentication",remove:"remove"},x={desktop:"desktop",web:"web"},M=!1,F=[],I=[],R=0,U={};z.themeChange=o,t.initialize=e,t.getContext=n,t.registerOnThemeChangeHandler=i,t.navigateCrossDomain=r,t.shareDeepLink=s;var W;!function(t){function e(t){a(D.settings,D.remove),p(C,"settings.setValidityState",[t])}function n(t){a(D.settings,D.remove);var e=p(C,"settings.getSettings");U[e]=t}function i(t){a(D.settings),p(C,"settings.setSettings",[t])}function o(t){a(D.settings),c=t}function r(t){a(D.remove),f=t}function s(){var t=new l;c?c(t):t.notifySuccess()}function u(){var t=new h;f?f(t):t.notifySuccess()}var c,f;z["settings.save"]=s,z["settings.remove"]=u,t.setValidityState=e,t.getSettings=n,t.setSettings=i,t.registerOnSaveHandler=o,t.registerOnRemoveHandler=r;var l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),p(C,"settings.save.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),p(C,"settings.save.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},t}(),h=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),p(C,"settings.remove.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),p(C,"settings.remove.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},t}()}(W=t.settings||(t.settings={}));var _;!function(t){function e(t){return a(D.content,D.settings,D.remove),i(t.url,t.width,t.height),S?void(l=t):void f("FailedToOpenWindow")}function n(){o();try{S&&S.close()}finally{S=null,E=null}}function i(t,e,i){n(),e=e||600,i=i||400,e=Math.min(e,k.outerWidth-400),i=Math.min(i,k.outerHeight-200);var o=document.createElement("a");if(o.href=t,T===x.desktop){var s=p(C,"authentication.allowWindowOpen",[o.href]);U[s]=function(t){if(!t)throw new Error("Authentication is only supported for URLs matching the pattern registered in the manifest.");S=k.open(o.href,"_blank","width="+e+", height="+i)}}else{var a="undefined"!=typeof k.screenLeft?k.screenLeft:k.screenX,u="undefined"!=typeof k.screenTop?k.screenTop:k.screenY;a+=k.outerWidth/2-e/2,u+=k.outerHeight/2-i/2,S=k.open(o.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, top="+u+", left="+a+", width="+e+", height="+i)}S&&r()}function o(){h&&(clearInterval(h),h=0),delete z.initialize,delete z.navigateCrossDomain}function r(){o(),h=setInterval(function(){if(!S||S.closed)f("CancelledByUser");else{var t=E;try{E="*",p(S,"ping")}finally{E=t}}},100),z.initialize=function(){return[D.authentication,T]},z.navigateCrossDomain=function(t){return!1}}function s(t){a(D.authentication),p(C,"authentication.authenticate.success",[t]),v(C,function(){return k.close()})}function u(t){a(D.authentication),p(C,"authentication.authenticate.failure",[t]),v(C,function(){return k.close()})}function c(t){try{l&&l.successCallback&&l.successCallback(t)}finally{l=null,n()}}function f(t){try{l&&l.failureCallback&&l.failureCallback(t)}finally{l=null,n()}}var l,h;z["authentication.authenticate.success"]=c,z["authentication.authenticate.failure"]=f,t.authenticate=e,t.notifySuccess=s,t.notifyFailure=u}(_=t.authentication||(t.authentication={}))}(microsoftTeams||(microsoftTeams={}));
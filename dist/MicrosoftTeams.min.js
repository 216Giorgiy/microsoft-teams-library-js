var microsoftTeams;!function(t){"use strict";function e(){if(p)throw new Error("initialize must not be called more than once.");p=!0;var t=this._window||window;if(u=t.parent!==t.self?t.parent:t.opener,!u)throw new Error("This page must be loaded in an iframe");var e=function(t){return a(t)};t.addEventListener("message",e,!1),this._uninitialize=function(){l===m.settings&&E.registerOnSaveHandler(null),l===m.remove&&E.registerOnRemoveHandler(null),p=!1,u=null,h=null,y=[],w=0,S={},l=null,t.removeEventListener("message",e,!1)};try{h="*";var n=c("initialize");S[n]=function(t){l=t}}finally{h=null}}function n(t){r();var e=c("getContext");S[e]=t}function i(t){r(),g=t}function o(t){g&&g(t)}function s(t){r();var e=c("navigateCrossDomain",t);S[e]=function(t){if(!t)throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")}}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(!p)throw new Error("The library has not yet been initialized");if(l&&t&&t.length>0){for(var n=!1,i=0;i<t.length;i++)if(t[i]===l){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+l+"' context")}}function a(t){if(t&&t.data&&"object"==typeof t.data){var e=t.origin||t.originalEvent.origin;if(v.indexOf(e.toLowerCase())!==-1){for(h=e;y.length>0;)u.postMessage(y.shift(),h);if("id"in t.data){var n=t.data,i=S[n.id];i&&i.apply(null,n.args)}else if("func"in t.data){var n=t.data,o=d[n.func];o&&o.apply(this,n.args)}}}}function c(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=f(t,e);return h?u.postMessage(i,h):y.push(i),i.id}function f(t,e){return{id:w++,func:t,args:e}}var u,h,l,g,v=["https://teams.microsoft.com","https://teams.skype.com","https://ppespaces.skype.com","https://devspaces.skype.com","http://dev.local"],d={},m={settings:"settings",content:"content",authentication:"authentication",remove:"remove"},p=!1,y=[],w=0,S={};d.themeChange=o,t.initialize=e,t.getContext=n,t.registerOnThemeChangeHandler=i,t.navigateCrossDomain=s;var E;!function(t){function e(t){r(m.settings,m.remove),c("settings.setValidityState",t)}function n(t){r(m.settings,m.remove);var e=c("settings.getSettings");S[e]=t}function i(t){r(m.settings),c("settings.setSettings",t)}function o(t){r(m.settings),u=t}function s(t){r(m.remove),h=t}function a(){var t=new l;u?u(t):t.notifySuccess()}function f(){var t=new g;h?h(t):t.notifySuccess()}var u,h;d["settings.save"]=a,d["settings.remove"]=f,t.setValidityState=e,t.getSettings=n,t.setSettings=i,t.registerOnSaveHandler=o,t.registerOnRemoveHandler=s;var l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),c("settings.save.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),c("settings.save.failure",t),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},t}(),g=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),c("settings.remove.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),c("settings.remove.failure",t),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},t}()}(E=t.settings||(t.settings={}));var N;!function(t){function e(t){r(m.content,m.settings,m.remove);var e=document.createElement("a");e.href=t.url;var n=c("authentication.authenticate",e.href,t.width,t.height);S[n]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function n(t){r(m.authentication),c("authentication.authenticate.success",t)}function i(t){r(m.authentication),c("authentication.authenticate.failure",t)}t.authenticate=e,t.notifySuccess=n,t.notifyFailure=i}(N=t.authentication||(t.authentication={}))}(microsoftTeams||(microsoftTeams={}));
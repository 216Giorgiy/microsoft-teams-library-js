var microsoftTeams;!function(t){"use strict";function e(){if(!W){W=!0,S=this._window||window;var t=function(t){return g(t)};S.addEventListener("message",t,!1),I=S.parent!==S.self?S.parent:S.opener;try{N="*";var e=C(I,"initialize",[D]);j[e]=function(t,e){M=t,O=e}}finally{N=null}this._uninitialize=function(){M===x.settings&&X.registerOnSaveHandler(null),M===x.remove&&X.registerOnRemoveHandler(null),W=!1,I=null,N=null,R=[],L=null,H=null,_=[],V=0,j={},M=null,O=null,S.removeEventListener("message",t,!1)}}}function n(t){h();var e=C(I,"getContext");j[e]=t}function i(t){h(),z=t}function a(t){z&&z(t),L&&C(L,"themeChange",[t])}function o(t){h(),B=t}function r(t){B&&B(t)}function s(t){h(x.content,x.settings,x.remove);var e=C(I,"navigateCrossDomain",[t]);j[e]=function(t){if(!t)throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")}}function c(t,e){h();var n=C(I,"getTabInstances",[e]);j[n]=t}function u(t,e){h();var n=C(I,"getMruTabInstances",[e]);j[n]=t}function f(t){h(x.content),C(I,"shareDeepLink",[t.subEntityId,t.subEntityLabel,t.subEntityWebUrl])}function l(t){h();var e=C(I,"navigateToTab",[t]);j[e]=function(t){if(!t)throw new Error("Invalid internalTabInstanceId and/or channelId were/was provided")}}function h(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!W)throw new Error("The library has not yet been initialized");if(M&&t&&t.length>0){for(var n=!1,i=0;i<t.length;i++)if(t[i]===M){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+M+"' context")}}function g(t){if(t&&t.data&&"object"==typeof t.data){var e=t.source||t.originalEvent.source,n=t.origin||t.originalEvent.origin;e===S||n!==S.location.origin&&F.indexOf(n.toLowerCase())===-1||(d(e,n),e===I?v(t):e===L&&p(t))}}function d(t,e){I&&t!==I?L&&t!==L||(L=t,H=e):(I=t,N=e),I&&I.closed&&(I=null,N=null),L&&L.closed&&(L=null,H=null),b(I),b(L)}function v(t){if("id"in t.data){var e=t.data,n=j[e.id];n&&(n.apply(null,e.args),delete j[e.id])}else if("func"in t.data){var e=t.data,i=U[e.func];i&&i.apply(this,e.args)}}function p(t){if("id"in t.data&&"func"in t.data){var e=t.data,n=U[e.func];if(n){var i=n.apply(this,e.args);i&&T(L,e.id,Array.isArray(i)?i:[i])}else{var a=C(I,e.func,e.args);j[a]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];L&&T(L,e.id,t)}}}}function m(t){return t===I?R:t===L?_:[]}function y(t){return t===I?N:t===L?H:null}function b(t){for(var e=y(t),n=m(t);t&&e&&n.length>0;)t.postMessage(n.shift(),e)}function w(t,e){var n=S.setInterval(function(){0===m(t).length&&(clearInterval(n),e())},100)}function C(t,e,n){var i=k(e,n),a=y(t);return t&&a?t.postMessage(i,a):m(t).push(i),i.id}function T(t,e,n){var i=E(e,n),a=y(t);t&&a&&t.postMessage(i,a)}function k(t,e){return{id:V++,func:t,args:e||[]}}function E(t,e){return{id:t,args:e||[]}}var S,I,N,L,H,M,O,z,D="1.1-prerel",F=["https://teams.microsoft.com","https://teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","http://dev.local"],U={},x={settings:"settings",content:"content",authentication:"authentication",remove:"remove"},A={desktop:"desktop",web:"web"},W=!1,R=[],_=[],V=0,j={};U.themeChange=a;var B;U.fullScreenChange=r,t.initialize=e,t.getContext=n,t.registerOnThemeChangeHandler=i,t.registerFullScreenHandler=o,t.navigateCrossDomain=s,t.getTabInstances=c,t.getMruTabInstances=u,t.shareDeepLink=f,t.navigateToTab=l;var X;!function(t){function e(t){h(x.settings,x.remove),C(I,"settings.setValidityState",[t])}function n(t){h(x.settings,x.remove);var e=C(I,"settings.getSettings");j[e]=t}function i(t){h(x.settings),C(I,"settings.setSettings",[t])}function a(t){h(x.settings),c=t}function o(t){h(x.remove),u=t}function r(){var t=new f;c?c(t):t.notifySuccess()}function s(){var t=new l;u?u(t):t.notifySuccess()}var c,u;U["settings.save"]=r,U["settings.remove"]=s,t.setValidityState=e,t.getSettings=n,t.setSettings=i,t.registerOnSaveHandler=a,t.registerOnRemoveHandler=o;var f=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),C(I,"settings.save.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),C(I,"settings.save.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},t}(),l=function(){function t(){this.notified=!1}return t.prototype.notifySuccess=function(){this.ensureNotNotified(),C(I,"settings.remove.success"),this.notified=!0},t.prototype.notifyFailure=function(t){this.ensureNotNotified(),C(I,"settings.remove.failure",[t]),this.notified=!0},t.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},t}()}(X=t.settings||(t.settings={}));var Y;!function(t){function e(t){if(h(x.content,x.settings,x.remove),O===A.desktop){var e=document.createElement("a");e.href=t.url;var n=C(I,"authentication.authenticate",[e.href,t.width,t.height]);j[n]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}else o(t)}function n(t){h();var e=C(I,"authentication.getAuthToken",[t.resources]);j[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function i(t){h();var e=C(I,"authentication.getUser");j[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}}function a(){r();try{L&&L.close()}finally{L=null,H=null}}function o(t){g=t,a();var e=g.width||600,n=g.height||400;e=Math.min(e,S.outerWidth-400),n=Math.min(n,S.outerHeight-200);var i=document.createElement("a");i.href=g.url;var o="undefined"!=typeof S.screenLeft?S.screenLeft:S.screenX,r="undefined"!=typeof S.screenTop?S.screenTop:S.screenY;o+=S.outerWidth/2-e/2,r+=S.outerHeight/2-n/2,L=S.open(i.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, top="+r+", left="+o+", width="+e+", height="+n),L?s():l("FailedToOpenWindow")}function r(){d&&(clearInterval(d),d=0),delete U.initialize,delete U.navigateCrossDomain}function s(){r(),d=S.setInterval(function(){if(!L||L.closed)l("CancelledByUser");else{var t=H;try{H="*",C(L,"ping")}finally{H=t}}},100),U.initialize=function(){return[x.authentication,O]},U.navigateCrossDomain=function(t){return!1}}function c(t){h(x.authentication),C(I,"authentication.authenticate.success",[t]),w(I,function(){return S.close()})}function u(t){h(x.authentication),C(I,"authentication.authenticate.failure",[t]),w(I,function(){return S.close()})}function f(t){try{g&&g.successCallback&&g.successCallback(t)}finally{g=null,a()}}function l(t){try{g&&g.failureCallback&&g.failureCallback(t)}finally{g=null,a()}}var g,d;U["authentication.authenticate.success"]=f,U["authentication.authenticate.failure"]=l,t.authenticate=e,t.getAuthToken=n,t.getUser=i,t.notifySuccess=c,t.notifyFailure=u}(Y=t.authentication||(t.authentication={}))}(microsoftTeams||(microsoftTeams={}));